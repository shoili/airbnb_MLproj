library(dplyr)

# available <- read.csv('available_listings.csv')
# listings <- read.csv("listings_final.csv")
# reviews <- read.csv("reviewsadj.csv")
# 
# avail <- merge(listings, available, by.x="id", by.y="listing_id", all.y=TRUE)
# left <- merge(avail, reviews, by.x="id", by.y="listing_id", 
#               all.x=TRUE)
# 
# avail_inner <- merge(listings, available, by.x="id", by.y="listing_id")
# inner <- merge(avail_inner, reviews, by.x="id", by.y="listing_id")
# 
# # left joined dataset
# left <- left %>%
#   select(-X.x, X, X.y)
# 
# # inner joined dataset
# inner <- inner %>%
#   select(-X.x, X, X.y)

inner <- read.csv("dat.csv", row.names = F)

inner <- subset(inner, select = -c(id))
# inner <- subset(inner, select = -c(X.x))
clean <- subset(inner, select = -c(amenities,amenities_list,price))

# linear regression

linearmodel <- lm(clean$price_num~as.numeric(unlist(clean[1]))+as.numeric(unlist(clean[2]))+as.numeric(unlist(clean[3]))+as.numeric(unlist(clean[4]))+as.numeric(unlist(clean[5]))+as.numeric(unlist(clean[6]))+as.numeric(unlist(clean[7]))+as.numeric(unlist(clean[8]))+as.numeric(unlist(clean[9]))+as.numeric(unlist(clean[10]))+as.numeric(unlist(clean[11]))+as.numeric(unlist(clean[12]))+as.numeric(unlist(clean[13]))+as.numeric(unlist(clean[14]))+as.numeric(unlist(clean[15]))+as.numeric(unlist(clean[16]))+as.numeric(unlist(clean[17]))+as.numeric(unlist(clean[18]))+as.numeric(unlist(clean[19]))+as.numeric(unlist(clean[20]))+as.numeric(unlist(clean[21]))+as.numeric(unlist(clean[22]))+as.numeric(unlist(clean[23]))+as.numeric(unlist(clean[24]))+as.numeric(unlist(clean[25]))+as.numeric(unlist(clean[26]))+as.numeric(unlist(clean[27]))+as.numeric(unlist(clean[28]))+as.numeric(unlist(clean[29]))+as.numeric(unlist(clean[30]))+as.numeric(unlist(clean[31]))+as.numeric(unlist(clean[32]))+as.numeric(unlist(clean[33]))+as.numeric(unlist(clean[34]))+as.numeric(unlist(clean[35]))+as.numeric(unlist(clean[36]))+as.numeric(unlist(clean[37]))+as.numeric(unlist(clean[38]))+as.numeric(unlist(clean[39]))+as.numeric(unlist(clean[40]))+as.numeric(unlist(clean[41]))+as.numeric(unlist(clean[42]))+as.numeric(unlist(clean[43]))+as.numeric(unlist(clean[44]))+as.numeric(unlist(clean[45]))+as.numeric(unlist(clean[46]))+as.numeric(unlist(clean[47]))+as.numeric(unlist(clean[48]))+as.numeric(unlist(clean[49]))+as.numeric(unlist(clean[50]))+as.numeric(unlist(clean[51]))+as.numeric(unlist(clean[52]))+as.numeric(unlist(clean[53]))+as.numeric(unlist(clean[54]))+as.numeric(unlist(clean[55]))+as.numeric(unlist(clean[56]))+as.numeric(unlist(clean[57]))+as.numeric(unlist(clean[58]))+as.numeric(unlist(clean[59]))+as.numeric(unlist(clean[60]))+as.numeric(unlist(clean[61]))+as.numeric(unlist(clean[62]))+as.numeric(unlist(clean[63]))+as.numeric(unlist(clean[64]))+as.numeric(unlist(clean[65]))+as.numeric(unlist(clean[66]))+as.numeric(unlist(clean[67]))+as.numeric(unlist(clean[68]))+as.numeric(unlist(clean[69]))+as.numeric(unlist(clean[70]))+as.numeric(unlist(clean[71]))+as.numeric(unlist(clean[72]))+as.numeric(unlist(clean[73]))+as.numeric(unlist(clean[74]))+as.numeric(unlist(clean[75]))+as.numeric(unlist(clean[76]))+as.numeric(unlist(clean[77]))+as.numeric(unlist(clean[78]))+as.numeric(unlist(clean[79]))+as.numeric(unlist(clean[80]))+as.numeric(unlist(clean[81]))+as.numeric(unlist(clean[82]))+as.numeric(unlist(clean[83]))+as.numeric(unlist(clean[84]))+as.numeric(unlist(clean[85]))+as.numeric(unlist(clean[86]))+as.numeric(unlist(clean[87]))+as.numeric(unlist(clean[88]))+as.numeric(unlist(clean[89]))+as.numeric(unlist(clean[90]))+as.numeric(unlist(clean[91]))+as.numeric(unlist(clean[92]))+as.numeric(unlist(clean[93]))+as.numeric(unlist(clean[94]))+as.numeric(unlist(clean[95]))+as.numeric(unlist(clean[96]))+as.numeric(unlist(clean[97]))+as.numeric(unlist(clean[98]))+as.numeric(unlist(clean[99]))+as.numeric(unlist(clean[100]))+as.numeric(unlist(clean[101]))+as.numeric(unlist(clean[102]))+as.numeric(unlist(clean[103]))+as.numeric(unlist(clean[104]))+as.numeric(unlist(clean[105]))+as.numeric(unlist(clean[106]))+as.numeric(unlist(clean[108]))+as.numeric(unlist(clean[109]))+as.numeric(unlist(clean[110]))+as.numeric(unlist(clean[111]))+as.numeric(unlist(clean[112]))+as.numeric(unlist(clean[113]))+as.numeric(unlist(clean[114]))+as.numeric(unlist(clean[115]))+as.numeric(unlist(clean[116]))+as.numeric(unlist(clean[117]))+as.numeric(unlist(clean[118])))
# colnames picks out variables that have 0.05 significance
colnames(clean[c(1,5:8,11,13:37,39:43,45:51,53:56,58:62,64:66,68:72,74:79,82:93,95,97:102,104:105,108,110:112,115:118)])
# this next one takes forever
library(MASS)
stepmodel <- stepAIC(linearmodel, direction="both")
# these bottom two don't actually work because of NAs
library(glmnet)
lassomodel <- glmnet(clean[c(1:106,108:118)],clean$price_num)
ridgemodel <- lm.ridge(clean$price_num~as.numeric(unlist(clean[1]))+as.numeric(unlist(clean[2]))+as.numeric(unlist(clean[3]))+as.numeric(unlist(clean[4]))+as.numeric(unlist(clean[5]))+as.numeric(unlist(clean[6]))+as.numeric(unlist(clean[7]))+as.numeric(unlist(clean[8]))+as.numeric(unlist(clean[9]))+as.numeric(unlist(clean[10]))+as.numeric(unlist(clean[11]))+as.numeric(unlist(clean[12]))+as.numeric(unlist(clean[13]))+as.numeric(unlist(clean[14]))+as.numeric(unlist(clean[15]))+as.numeric(unlist(clean[16]))+as.numeric(unlist(clean[17]))+as.numeric(unlist(clean[18]))+as.numeric(unlist(clean[19]))+as.numeric(unlist(clean[20]))+as.numeric(unlist(clean[21]))+as.numeric(unlist(clean[22]))+as.numeric(unlist(clean[23]))+as.numeric(unlist(clean[24]))+as.numeric(unlist(clean[25]))+as.numeric(unlist(clean[26]))+as.numeric(unlist(clean[27]))+as.numeric(unlist(clean[28]))+as.numeric(unlist(clean[29]))+as.numeric(unlist(clean[30]))+as.numeric(unlist(clean[31]))+as.numeric(unlist(clean[32]))+as.numeric(unlist(clean[33]))+as.numeric(unlist(clean[34]))+as.numeric(unlist(clean[35]))+as.numeric(unlist(clean[36]))+as.numeric(unlist(clean[37]))+as.numeric(unlist(clean[38]))+as.numeric(unlist(clean[39]))+as.numeric(unlist(clean[40]))+as.numeric(unlist(clean[41]))+as.numeric(unlist(clean[42]))+as.numeric(unlist(clean[43]))+as.numeric(unlist(clean[44]))+as.numeric(unlist(clean[45]))+as.numeric(unlist(clean[46]))+as.numeric(unlist(clean[47]))+as.numeric(unlist(clean[48]))+as.numeric(unlist(clean[49]))+as.numeric(unlist(clean[50]))+as.numeric(unlist(clean[51]))+as.numeric(unlist(clean[52]))+as.numeric(unlist(clean[53]))+as.numeric(unlist(clean[54]))+as.numeric(unlist(clean[55]))+as.numeric(unlist(clean[56]))+as.numeric(unlist(clean[57]))+as.numeric(unlist(clean[58]))+as.numeric(unlist(clean[59]))+as.numeric(unlist(clean[60]))+as.numeric(unlist(clean[61]))+as.numeric(unlist(clean[62]))+as.numeric(unlist(clean[63]))+as.numeric(unlist(clean[64]))+as.numeric(unlist(clean[65]))+as.numeric(unlist(clean[66]))+as.numeric(unlist(clean[67]))+as.numeric(unlist(clean[68]))+as.numeric(unlist(clean[69]))+as.numeric(unlist(clean[70]))+as.numeric(unlist(clean[71]))+as.numeric(unlist(clean[72]))+as.numeric(unlist(clean[73]))+as.numeric(unlist(clean[74]))+as.numeric(unlist(clean[75]))+as.numeric(unlist(clean[76]))+as.numeric(unlist(clean[77]))+as.numeric(unlist(clean[78]))+as.numeric(unlist(clean[79]))+as.numeric(unlist(clean[80]))+as.numeric(unlist(clean[81]))+as.numeric(unlist(clean[82]))+as.numeric(unlist(clean[83]))+as.numeric(unlist(clean[84]))+as.numeric(unlist(clean[85]))+as.numeric(unlist(clean[86]))+as.numeric(unlist(clean[87]))+as.numeric(unlist(clean[88]))+as.numeric(unlist(clean[89]))+as.numeric(unlist(clean[90]))+as.numeric(unlist(clean[91]))+as.numeric(unlist(clean[92]))+as.numeric(unlist(clean[93]))+as.numeric(unlist(clean[94]))+as.numeric(unlist(clean[95]))+as.numeric(unlist(clean[96]))+as.numeric(unlist(clean[97]))+as.numeric(unlist(clean[98]))+as.numeric(unlist(clean[99]))+as.numeric(unlist(clean[100]))+as.numeric(unlist(clean[101]))+as.numeric(unlist(clean[102]))+as.numeric(unlist(clean[103]))+as.numeric(unlist(clean[104]))+as.numeric(unlist(clean[105]))+as.numeric(unlist(clean[106]))+as.numeric(unlist(clean[108]))+as.numeric(unlist(clean[109]))+as.numeric(unlist(clean[110]))+as.numeric(unlist(clean[111]))+as.numeric(unlist(clean[112]))+as.numeric(unlist(clean[113]))+as.numeric(unlist(clean[114]))+as.numeric(unlist(clean[115]))+as.numeric(unlist(clean[116]))+as.numeric(unlist(clean[117]))+as.numeric(unlist(clean[118])))
